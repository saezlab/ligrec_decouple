# Spatial-LR score Evaluation

## Reproduce Spatial Analysis

```
Scripts to preproduce the analysis can be found in /analysis/spatial/*
`*_prep.R` scripts are used to prepare the data
`spatial_analyse.R` is the main script to reproduce the results presented in the paper.
```

### Preprocess
1.1) Mouse Cortex visium slides were pre-processed using the [`mouse_brain_prep.R`](https://github.com/saezlab/ligrec_decouple/tree/main/analysis/spatial/mouse_brain_prep.R) script.
1.2) BRCA 10x Visium slides werwere pre-processed and deconvoluted using using the [`breast_cancer_prep.R`](https://github.com/saezlab/ligrec_decouple/tree/main/analysis/spatial/mouse_brain_prep.R) and [`breast_cancer_prep.R`](https://github.com/saezlab/ligrec_decouple/tree/main/analysis/spatial/mouse_brain_deconv.R) scripts, respectively.
1.3) Run [`squidpy_FISH_prep.Rmd`](https://github.com/saezlab/ligrec_decouple/tree/main/analysis/spatial/squidpy_FISH_prep.Rmd) to preprocess seq- and merFISH datasets. 

### Analysis
Run the [`spatial_analyse.R`](https://github.com/saezlab/ligrec_decouple/tree/main/analysis/spatial/spatial_analyse.R) script.


## Datasets
### Mouse Cortex

Spatial transcriptomics datasets (10x Visium slides) on sagittal adult mouse brain
anterior and posterior slices were obtained from [`SeuratData`v0.2.1](https://github.com/satijalab/seurat-data),
available under the dataset name of `stxBrain`.

Cell type mapping on the mouse brain slides was performed using [`SPOTlight`](https://academic.oup.com/nar/article/49/9/e50/6129341#248806291), with
100 cells per cluster as in the SPOTlight publication. 

As reference for the cell type mapping, we used [a processed Seurat](https://satijalab.org/seurat/articles/spatial_vignette.html) object of the Allen Brain Atlas ([Tasic et al., 2016](https://www.nature.com/articles/nn.4216))

### [Wu et al., 21](https://www.nature.com/articles/s41588-021-00911-1) Human Breast Cancer (BRCA)

6 BRCA 10x Visium slides were obtained from https://zenodo.org/record/4739739, and deconvoluted using the [single-cell atlas](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE176078) generated by the [same publication](https://www.nature.com/articles/s41588-021-00911-1).

Slides were deconvoluted by cancer subtype, as in the original publication.

### seq/merFISH
preprocessed seqFISH and merFISH datasets were obtained from [Squidpy](https://squidpy.readthedocs.io/en/latest/api.html#module-squidpy.datasets).
The [seqFISH](https://squidpy.readthedocs.io/en/stable/auto_tutorials/tutorial_seqfish.html#sphx-glr-auto-tutorials-tutorial-seqfish-py) was originally published in
[Lohoff et al., 2021](https://www.biorxiv.org/content/10.1101/2020.11.20.391896v1.abstract).
The [merFISH](https://squidpy.readthedocs.io/en/stable/auto_tutorials/tutorial_merfish.html#sphx-glr-auto-tutorials-tutorial-merfish-py) was originally published in
[Moffitt et al., 2018](https://www.science.org/doi/10.1126/science.aau5324).
