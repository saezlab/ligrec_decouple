---
title: "check_inbuilt"
author: "Daniel Dimitrov"
date: "18/06/2021"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE,
                      root.dir = withr::with_dir("../..", rprojroot::find_root("LICENSE")))
require(liana)
require(tidyverse)
require(magrittr)

#' Helper Function to get uniques values of a given column
#' @param left_res e.g. OmniPath version of a Resource
#' @param right_res e.g. Inbuilt version of a Resource
#' @param column name of the column to check
get_uniques <- function(left_res, right_res, column){
    jacc <- length(intersect(left_res[[column]], right_res[[column]]))/
        length(union(left_res[[column]], right_res[[column]]))
    message(
        str_glue("Jacc Index: {round(jacc, digits = 3)}")
    )

    left_res %>%
        select(!!column) %>%
        filter(!(.data[[column]] %in% right_res[[column]])) %>%
        distinct()
}
```


## Here, we will check how well OP represents OG resources
```{r list_resources}
liana:::show_resources()
# To check (Jaccard Index between interactions):
# 1. CellChatDB (>0.965dm) *
# 2. ICELLNET (>9.49d) *
# 3. iTALK (>0.953) - many genesymbols are outdated in the inbuilt
# 4. Ramilowski2015 (>0.95) + many genesymbols are outdated in the inbuilt
# 5. ConnectomeDB/NATMI (0.984)
# 6. LRdb (>0.97)
# 7. CellTalkDB (0.982)
# 8. Cellinker (>0.976)
# 9. CellCall (~0.7 -> recreate)
# 10. scConnect (deleted)

# CPDB - We cannot as parter_a and partner_b are ambigous
# Baccin2019 - converted to murine in OmniPath

# Unsure whether to check (and how):
# EMBRACE, HPMR, Kirouac2010, Guide2Pharma


```



### I) Check CellChatDB
##### inbuilt Resource CellChatDB
```{r cellchat}
cc_inbuilt <- CellChat::CellChatDB.human %>%
    pluck("interaction") %>%
    select(interaction_name,
         source_genesymbol = ligand, 
         target_genesymbol = receptor) %>%
  mutate(across(everything(), ~str_to_upper(.x))) %>%
  mutate(across(everything(), ~gsub("*\\s..*" ,"" , .x))) %>%
  mutate(across(everything(), ~gsub("\\:" ,"_" , .x)))

# ITGA1_ITGB1-interactions are missing from OmniPath's CellChatDB -> we append them
itga_cc <- cc_inbuilt %>%
    filter(str_detect(target_genesymbol, "ITGA1_ITGB1"))


# Modify Omni-cc
cc_omnipath <- select_resource("CellChatDB")[[1]] %>%
  bind_rows(itga_cc)
  
# Format to CellChatDB
cc_omnipath <- cellchat_formatDB(CellChat::CellChatDB.human,
                                 cc_omnipath,
                                 exclude_anns = c()) %>%
  pluck("interaction") %>%
  select(interaction_name,
         source_genesymbol = ligand, 
         target_genesymbol = receptor) %>%
  mutate(across(everything(), ~str_to_upper(.x))) %>%
  mutate(across(everything(), ~gsub("INHA_" ,"" , .x))) 

  

# 1,939 interactions for Original CellChatDB, 1,882 for OmniPath
cc_omnipath %>% glimpse()
cc_inbuilt %>% glimpse()

# examine
cc_fj <- full_join(cc_omnipath,
                   cc_inbuilt, by="interaction_name") %>% 
  filter_all(any_vars(is.na(.)))
```


#### 1) Unique Interactions
```{r cellchat_interactions}
get_uniques(cc_omnipath, cc_inbuilt, "interaction_name") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cc_inbuilt, cc_omnipath, "interaction_name") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 1.1) Unique Interactions (decomplexified)
```{r cellchat_interactions}

cc_inbuilt_decomplex <- cc_inbuilt %>%
  liana:::decomplexify() %>%
  filter(target_genesymbol != source_genesymbol) %>%
  unite(target_genesymbol,
        source_genesymbol,
        col = "interaction", remove = FALSE)

cc_omnipath_decomplex <- cc_omnipath %>%
  liana:::decomplexify() %>%
  unite(target_genesymbol,
        source_genesymbol,
        col = "interaction", remove = FALSE)

get_uniques(cc_omnipath_decomplex, cc_inbuilt_decomplex, "interaction") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cc_inbuilt_decomplex, cc_omnipath_decomplex, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt

# examine
cc_fj <- full_join(cc_omnipath_decomplex,
                   cc_inbuilt_decomplex,
                   by="interaction") %>% 
  filter_all(any_vars(is.na(.)))

```


#### 2) Unique Ligands
```{r cellchat_ligands}
get_uniques(cc_omnipath_decomplex, cc_inbuilt_decomplex, "source_genesymbol") %>%
  rmarkdown::paged_table()  # Unique to OmniPath

get_uniques(cc_inbuilt_decomplex, cc_omnipath_decomplex, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 3) Unique Receptors
```{r cellchat_receptors}
get_uniques(cc_omnipath, cc_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table()  # Unique to OmniPath

get_uniques(cc_inbuilt, cc_omnipath, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


#### 4) Unique Interactions from `import_intercell_network`
```{r import_intercell}
cc_intercell <- OmnipathR::import_intercell_network(resources = "CellChatDB") %>% 
  select(receptor = target_genesymbol,
         ligand = source_genesymbol) %>% 
  unite(ligand, receptor, col = "interaction_name")


get_uniques(cc_intercell, cc_inbuilt, "interaction_name") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cc_inbuilt, cc_intercell, "interaction_name") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

### II) Check SingleCellSignalR
##### Inbuilt Resource LRdb
```{r sca}
lrdb_omni <- select_resource("LRdb")[[1]] %>%
    sca_formatDB() %>%
    unite(ligand, receptor, col = "interaction", remove = FALSE)

load("data/input/LRdb.rda")
lrdb_inbuilt <- LRdb %>%
    unite(ligand, receptor, col = "interaction", remove = FALSE)

lrdb_omni %>% glimpse()
lrdb_inbuilt %>% glimpse()
```



#### 1) Unique Interactions
```{r sca_interactions}
get_uniques(lrdb_omni, lrdb_inbuilt, "interaction")  %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(lrdb_inbuilt, lrdb_omni, "interaction")  %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```
#### 2) Unique Ligands
```{r sca_ligands}
get_uniques(lrdb_omni, lrdb_inbuilt, "ligand") %>%
  rmarkdown::paged_table()  # Unique to OmniPath

get_uniques(lrdb_inbuilt, lrdb_omni, "ligand") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 3) Unique Receptors
```{r sca_receptors}
get_uniques(lrdb_omni, lrdb_inbuilt, "receptor") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(lrdb_inbuilt, lrdb_omni, "receptor") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


### III) Check iTALK
##### inbuilt Resource iTALK
```{r italk}
italk_omni <- select_resource("iTALK")[[1]] %>%
    italk_formatDB() %>%
  rename(interaction = Pair.Name,
         source_genesymbol = Ligand.ApprovedSymbol,
         target_genesymbol = Receptor.ApprovedSymbol) %>%
  mutate(across(everything(), ~str_to_upper(.x))) 

italk_inbuilt <- iTALK::database %>%
  rename(source_genesymbol = Ligand.ApprovedSymbol,
         target_genesymbol = Receptor.ApprovedSymbol) %>%
  mutate(across(everything(), ~str_to_upper(.x))) %>%
  # OmniPath uniprot IDs to latest genesymbol
  mutate(target_genesymbol =  str_replace(target_genesymbol, "DARC", "ACKR1")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "HFE2", "HJV")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "AREGB", "AREG")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "PVRL", "NECTIN")) %>%
  mutate(source_genesymbol = str_replace(source_genesymbol, "MLLT4", "AFDN")) %>%
  mutate(source_genesymbol = str_replace(source_genesymbol, "FIGF", "VEGFD")) %>%
  unite(source_genesymbol, target_genesymbol, col="interaction", remove = FALSE)

# Glimpse Both
italk_omni %>% glimpse()
italk_inbuilt %>% glimpse()
```

#### 1) Unique Interactions
```{r italk_interactions}
get_uniques(italk_omni, italk_inbuilt, "interaction") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(italk_inbuilt, italk_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 2) Unique Ligands
```{r italk_ligands}
get_uniques(italk_omni, italk_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(italk_inbuilt, italk_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


# 3) Unique Receptors
```{r italk_receptors}
get_uniques(italk_omni, italk_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath
get_uniques(italk_inbuilt, italk_omni, "target_genesymbol") %>%
  rmarkdown::paged_table()# Unique to Inbuilt
```


### IV) FANTOM5 (Ramilowski2015) (Connectome's default)
```{r conn}
fantom_omni <- select_resource("Ramilowski2015")[[1]] %>%
  conn_formatDB() %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

fantom_inbuilt <- Connectome::ncomms8866_human %>%
            filter(Pair.Evidence == "literature supported") %>%
    select(source_genesymbol = Ligand.ApprovedSymbol,
           target_genesymbol = Receptor.ApprovedSymbol) %>%
  mutate(target_genesymbol =  str_replace(target_genesymbol, "DARC", "ACKR1")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "HFE2", "HJV")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "AREGB", "AREG")) %>%
  mutate(target_genesymbol = str_replace(target_genesymbol, "PVRL", "NECTIN")) %>%
  mutate(source_genesymbol = str_replace(source_genesymbol, "MLLT4", "AFDN")) %>%
  mutate(source_genesymbol = str_replace(source_genesymbol, "FIGF", "VEGFD")) %>%
  unite(source_genesymbol, target_genesymbol, col = "interaction", remove = FALSE)
  
# Glimpse Both
fantom_omni %>% glimpse()
fantom_inbuilt %>% glimpse()
```

```{r conn_interactions}
#### 1) Unique Interactions
get_uniques(fantom_omni, fantom_inbuilt, "interaction") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(fantom_inbuilt, fantom_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 2) Unique Ligands
```{r conn_ligands}
get_uniques(fantom_omni, fantom_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(fantom_inbuilt, fantom_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 3) Unique Receptors
```{r conn_receptors}
get_uniques(fantom_omni, fantom_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(fantom_inbuilt, fantom_omni, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


### V) NATMI
##### Inbuilt Resource is ConnectomeDB (aka Ramilowski2015 follow up)

```{r natmi}
natmi_omni <- select_resource("connectomeDB2020")[[1]] %>%
    unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

natmi_inbuilt <- read.csv("renv/library/R-4.0/x86_64-pc-linux-gnu/liana/NATMI/lrdbs/lrc2p.csv") %>%
  select(source_genesymbol = Ligand.gene.symbol,
         target_genesymbol = Receptor.gene.symbol) %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

# Glimpse Both
natmi_omni %>% glimpse()
natmi_inbuilt %>% glimpse()
```

```{r natmi_interactions}
#### 1) Unique Interactions
get_uniques(natmi_omni, natmi_inbuilt, "interaction") %>%
  rmarkdown::paged_table()# Unique to OmniPath

get_uniques(natmi_inbuilt, natmi_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

```{r natmi_ligands}
#### 2) Unique Ligands
get_uniques(natmi_omni, natmi_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(natmi_inbuilt, natmi_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

```{r natmi_receptors}
#### 3) Unique Receptors
get_uniques(natmi_omni, natmi_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(natmi_inbuilt, natmi_omni, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


### VI) ICELLNET

```{r icellnet}
icellnet_omni <- select_resource("ICELLNET")[[1]] %>%
    unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

# Original ICELLNET
icellnet_inbuilt <- read.delim("https://raw.githubusercontent.com/soumelis-lab/ICELLNET/master/data/ICELLNETdb.csv",
                       sep=";")  %>%
  distinct_at(vars("Ligand.1", "Ligand.2",
                   "Receptor.1", "Receptor.2",
                   "Receptor.3")) %>%
  unite("Ligand.1", "Ligand.2", col = "source_genesymbol") %>%
  unite("Receptor.1", "Receptor.2", "Receptor.3", col = "target_genesymbol") %>%
  mutate(target_genesymbol =  sub("\\__[^_]*$", "", target_genesymbol)) %>%
  mutate(target_genesymbol =  sub("\\_[^_]*$", "", target_genesymbol))  %>%
  mutate(source_genesymbol =  sub("\\__[^_]*$", "", source_genesymbol)) %>%
  mutate(source_genesymbol =  sub("\\_[^_]*$", "", source_genesymbol)) %>%
  unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)


# Glimpse Both
icellnet_omni %>% glimpse()
icellnet_inbuilt %>% glimpse()
```

```{r icellnet}
#### 1) Unique Interactions
get_uniques(icellnet_omni, icellnet_inbuilt, "interaction") %>%
  rmarkdown::paged_table()# Unique to OmniPath

get_uniques(icellnet_inbuilt, icellnet_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt

## Often the order of complex subunits is different
```

```{r icellnet}
# Check when decomplexified
icellnet_omni_decomplex <- select_resource("ICELLNET")[[1]] %>%
  liana:::decomplexify() %>%
  unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

# Original ICELLNET
icellnet_inbuilt_decomplex <- read.delim("https://raw.githubusercontent.com/soumelis-lab/ICELLNET/master/data/ICELLNETdb.csv",
                       sep=";")  %>%
  distinct_at(vars("Ligand.1", "Ligand.2",
                   "Receptor.1", "Receptor.2",
                   "Receptor.3")) %>%
  unite("Ligand.1", "Ligand.2", col = "source_genesymbol") %>%
  unite("Receptor.1", "Receptor.2", "Receptor.3", col = "target_genesymbol") %>%
  mutate(target_genesymbol =  sub("\\__[^_]*$", "", target_genesymbol)) %>%
  mutate(target_genesymbol =  sub("\\_[^_]*$", "", target_genesymbol))  %>%
  mutate(source_genesymbol =  sub("\\__[^_]*$", "", source_genesymbol)) %>%
  mutate(source_genesymbol =  sub("\\_[^_]*$", "", source_genesymbol)) %>%
  liana:::decomplexify() %>%
  unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

#### 1.1) Unique Interactions (decomplex)
get_uniques(icellnet_omni_decomplex,
            icellnet_inbuilt_decomplex, "interaction") %>%
  rmarkdown::paged_table()# Unique to OmniPath

get_uniques(icellnet_inbuilt_decomplex, icellnet_omni_decomplex, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


```{r icellnet}
#### 2) Unique Ligands
get_uniques(icellnet_omni, icellnet_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(icellnet_inbuilt, icellnet_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

```{r icellnet}
#### 3) Unique Receptors
get_uniques(icellnet_omni, icellnet_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(icellnet_inbuilt, icellnet_omni, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

### VII) CellTalkDB
```{r celltalkdb}
celltalkdb_omni <- select_resource("CellTalkDB")[[1]] %>%
    unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

# Original celltalkdb
celltalkdb_inbuilt <- read.table("data/input/human_lr_pair.txt", header = TRUE) %>%
  select(interaction = lr_pair,
         source_genesymbol = ligand_gene_symbol,
         target_genesymbol = receptor_gene_symbol)

celltalkdb_omni %>% glimpse()
celltalkdb_inbuilt %>% glimpse()

```

```{r celltalkdb}
#### 1) Unique Interactions
get_uniques(celltalkdb_omni, celltalkdb_inbuilt, "interaction") %>%
  rmarkdown::paged_table()# Unique to OmniPath

get_uniques(celltalkdb_inbuilt, celltalkdb_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

```{r celltalkdb}
#### 2) Unique Ligands
get_uniques(celltalkdb_omni, celltalkdb_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(celltalkdb_inbuilt, celltalkdb_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

```{r celltalkdb}
#### 3) Unique Receptors
get_uniques(celltalkdb_omni, celltalkdb_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(celltalkdb_inbuilt, celltalkdb_omni, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```



### VIII) Cellinker
```{r cellinker}
cellinker_omni <- select_resource("Cellinker")[[1]] %>%
  liana:::decomplexify() %>%
    unite(source_genesymbol, target_genesymbol,
          col = "interaction", remove = FALSE)

# Original celltalkdb
cellinker_inbuilt <- read.delim(url("http://www.rna-society.org/cellinker/download/Homo%20sapiens.txt"), header = TRUE) %>%
  dplyr::rename(source_genesymbol = Ligand_symbol,
                target_genesymbol = Receptor_symbol
                ) %>%
  mutate(across(ends_with("genesymbol"), ~gsub("\\;", "\\_", .x))) %>%
  liana:::decomplexify() %>%
  filter(source_genesymbol != target_genesymbol) %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

cellinker_omni %>% glimpse()
cellinker_inbuilt %>% glimpse()
```

#### 1) Unique Interactions
```{r cellchat_interactions}
get_uniques(cellinker_omni, cellinker_inbuilt, "interaction") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cellinker_inbuilt, cellinker_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


#### 2) Unique Ligands
```{r cellchat_interactions}
get_uniques(cellinker_omni, cellinker_inbuilt, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cellinker_inbuilt, cellinker_omni, "source_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

#### 3) Unique Receptors
```{r cellchat_interactions}
get_uniques(cellinker_omni, cellinker_inbuilt, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cellinker_inbuilt, cellinker_omni, "target_genesymbol") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```


### IX) CellCall
```{r cellcall}
cellcall_omni <- select_resource("CellCall")[[1]] %>%
  liana:::decomplexify() %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

# Original celltalkdb
cellcall_inbuilt <- read.delim(url("https://raw.githubusercontent.com/ShellyCoder/cellcall/master/inst/extdata/new_ligand_receptor_TFs.txt"), header = TRUE) %>%
  mutate(across(everything(), ~as.character(.x))) %>%
  bind_rows(read.delim(url("https://raw.githubusercontent.com/ShellyCoder/cellcall/master/inst/extdata/new_ligand_receptor_TFs_extended.txt"), header = TRUE) %>%
  mutate(across(everything(), ~as.character(.x)))) %>%
  select(source_genesymbol = Ligand_Symbol,
         target_genesymbol = Receptor_Symbol) %>%
  filter(source_genesymbol != target_genesymbol) %>%
  mutate(across(ends_with("genesymbol"), ~gsub("\\,", "\\_", .x))) %>%
  distinct() %>%
  filter(source_genesymbol != target_genesymbol) %>%
  # liana:::decomplexify() %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

cellcall_omni %>% glimpse()
cellcall_inbuilt %>% glimpse()
```

#### 1) Unique Interactions
```{r cellcall_int}
get_uniques(cellcall_omni, cellcall_inbuilt, "interaction") %>%
  rmarkdown::paged_table() # Unique to OmniPath

get_uniques(cellcall_inbuilt, cellcall_omni, "interaction") %>%
  rmarkdown::paged_table() # Unique to Inbuilt
```

### X) scConnect
```{r scConnect}

scconn_omni <- select_resource("scConnect")[[1]] %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

scconn_inbuilt <- read.csv(url("https://raw.githubusercontent.com/JonETJakobsson/scConnect/master/scConnect/data/GTP_tables_clean/2020-5/interactions.csv"),
                           header = TRUE) %>%
  filter(target_species == "Human") %>%
  filter(ligand_species == "Human") %>%
  select(target_genesymbol = target_gene_symbol,
         source_genesymbol = ligand_gene_symbol) %>%
  filter(source_genesymbol != "" & target_genesymbol != "") %>%
  mutate(across(ends_with("genesymbol"), ~gsub("\\|", "\\_", .x))) %>%
  # mutate(across(everything(), ~str_to_upper(.x))) %>%
  filter(source_genesymbol != target_genesymbol) %>%
  distinct() %>%
  unite(source_genesymbol, target_genesymbol,
        col = "interaction", remove = FALSE)

scconn_omni %>% glimpse()
scconn_inbuilt %>% glimpse()
```


